<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fundos Imobiliários - Dados em Tempo Real</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding-top: 20px;
            -webkit-text-size-adjust: 100%;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            margin-bottom: 20px;
            border: none;
            overflow: hidden;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            font-weight: 600;
            padding: 15px;
        }
        
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background-color: var(--secondary-color);
            color: white;
            position: sticky;
            top: 0;
            padding: 12px 10px;
            font-size: 0.9rem;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .positive {
            color: #27ae60;
            font-weight: 600;
        }
        
        .negative {
            color: #e74c3c;
            font-weight: 600;
        }
        
        .neutral {
            color: #f39c12;
            font-weight: 600;
        }
        
        .summary-card {
            background-color: var(--light-color);
            border-left: 4px solid var(--secondary-color);
        }
        
        .progress {
            height: 8px;
            margin-bottom: 5px;
        }
        
        .filter-section {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }
        
        .ticker-label {
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            display: inline-block;
            margin-right: 5px;
            margin-bottom: 5px;
            font-size: 0.85rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .btn-ios {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-weight: 600;
            margin: 10px 0;
            display: inline-block;
            text-align: center;
            width: 100%;
        }
        
        .last-update {
            font-size: 0.8rem;
            color: #7f8c8d;
            text-align: right;
            margin-bottom: 10px;
        }
        
        .blink {
            animation: blink-animation 2s infinite;
        }
        
        @keyframes blink-animation {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @media (max-width: 768px) {
            th, td {
                padding: 8px 5px;
                font-size: 0.8rem;
            }
            
            .card {
                margin-bottom: 15px;
            }
            
            .table-responsive {
                font-size: 0.85rem;
                overflow-x: auto;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h1><i class="fas fa-chart-line me-2"></i>Fundos Imobiliários em Tempo Real</h1>
            <p class="lead">Dados atualizados automaticamente a cada 30 segundos</p>
            <div class="mt-3">
                <span class="ticker-label" style="background-color: #3498db;">GARE11</span>
                <span class="ticker-label" style="background-color: #2ecc71;">CACR11</span>
                <span class="ticker-label" style="background-color: #e74c3c;">KNCR11</span>
                <span class="ticker-label" style="background-color: #f39c12;">SNEL11</span>
                <span class="ticker-label" style="background-color: #9b59b6;">XPML11</span>
            </div>
            <div class="mt-3">
                <span class="badge bg-success blink"><i class="fas fa-sync-alt me-1"></i> Atualizando automaticamente</span>
                <p class="last-update" id="lastUpdate">Última atualização: carregando...</p>
            </div>
        </div>
        
        <div class="filter-section mb-4">
            <div class="row">
                <div class="col-md-6 mb-2">
                    <label for="sortSelect" class="form-label">Ordenar por:</label>
                    <select class="form-select" id="sortSelect">
                        <option value="ticker">Ticker</option>
                        <option value="dy">Dividend Yield (DY)</option>
                        <option value="pvp">P/VP</option>
                        <option value="wualt">WUALT</option>
                    </select>
                </div>
                <div class="col-md-6 mb-2">
                    <label for="searchInput" class="form-label">Buscar:</label>
                    <input type="text" class="form-control" id="searchInput" placeholder="Digite o ticker ou característica...">
                </div>
            </div>
        </div>
        
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Ticker</th>
                        <th>Preço (R$)</th>
                        <th>Variação</th>
                        <th>DY (%)</th>
                        <th>P/VP</th>
                        <th>Composição</th>
                        <th>Gestão</th>
                        <th>Taxa Adm</th>
                    </tr>
                </thead>
                <tbody id="fiiTableBody">
                    <!-- Os dados serão preenchidos via JavaScript -->
                </tbody>
            </table>
        </div>
        
        <div class="table-responsive mt-4">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Ticker</th>
                        <th>WUALT</th>
                        <th>Inadimplência</th>
                        <th>Endividamento</th>
                        <th>Cotistas</th>
                        <th>Resiliência</th>
                        <th>Últ. Rendimento</th>
                    </tr>
                </thead>
                <tbody id="fiiTableBody2">
                    <!-- Os dados serão preenchidos via JavaScript -->
                </tbody>
            </table>
        </div>
        
        <h2 class="mt-5 mb-4">Análises Individuais</h2>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">GARE11 - <small>Galpões Logísticos</small></div>
                    <div class="card-body">
                        <h5 class="card-title">Análise <span class="badge bg-secondary" id="gare11Price">Carregando...</span></h5>
                        <p class="card-text">Foco em galpões logísticos em regiões estratégicas. Baixa inadimplência e endividamento controlado. Alta resiliência em crises devido à demanda constante por armazenamento.</p>
                        <div class="progress">
                            <div class="progress-bar bg-success" style="width: 85%"></div>
                        </div>
                        <small>Classificação: 8.5/10 | <span id="gare11Update">Atualizando...</span></small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">CACR11 - <small>Crédito Imobiliário</small></div>
                    <div class="card-body">
                        <h5 class="card-title">Análise <span class="badge bg-secondary" id="cacr11Price">Carregando...</span></h5>
                        <p class="card-text">Expõe-se ao crédito imobiliário com bons retornos, porém com inadimplência acima da média. Gestão experiente do BTG, mas vulnerável a crises econômicas.</p>
                        <div class="progress">
                            <div class="progress-bar bg-warning" style="width: 70%"></div>
                        </div>
                        <small>Classificação: 7.0/10 | <span id="cacr11Update">Atualizando...</span></small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">KNCR11 - <small>Títulos e Débentures</small></div>
                    <div class="card-body">
                        <h5 class="card-title">Análise <span class="badge bg-secondary" id="kncr11Price">Carregando...</span></h5>
                        <p class="card-text">Maior DY da carteira, mas com maiores riscos. Alta inadimplência e endividamento elevado. Pode sofrer bastante em cenários de crise ou altas taxas de juros.</p>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 60%"></div>
                        </div>
                        <small>Classificação: 6.0/10 | <span id="kncr11Update">Atualizando...</span></small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">SNEL11 - <small>Energia Solar</small></div>
                    <div class="card-body">
                        <h5 class="card-title">Análise <span class="badge bg-secondary" id="snel11Price">Carregando...</span></h5>
                        <p class="card-text">Fundo inovador com foco em energia solar. Baixíssima inadimplência e endividamento. Setor com grande potencial de crescimento e resiliente a crises.</p>
                        <div class="progress">
                            <div class="progress-bar bg-success" style="width: 90%"></div>
                        </div>
                        <small>Classificação: 9.0/10 | <span id="snel11Update">Atualizando...</span></small>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6 mx-auto">
                <div class="card">
                    <div class="card-header">XPML11 - <small>Shoppings e Lajes</small></div>
                    <div class="card-body">
                        <h5 class="card-title">Análise <span class="badge bg-secondary" id="xpml11Price">Carregando...</span></h5>
                        <p class="card-text">Diversificado entre shoppings e lajes corporativas. Maior número de cotistas, indicando boa liquidez. Performance mediana na maioria dos indicadores.</p>
                        <div class="progress">
                            <div class="progress-bar bg-warning" style="width: 75%"></div>
                        </div>
                        <small>Classificação: 7.5/10 | <span id="xpml11Update">Atualizando...</span></small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card summary-card mt-5">
            <div class="card-body">
                <h4 class="card-title"><i class="fas fa-lightbulb me-2"></i>Resumo da Carteira</h4>
                <p class="card-text">Sua carteira é diversificada entre diferentes segmentos de FIIs. Possui boas opções defensivas (GARE11, SNEL11) e outras mais arriscadas com potencial de retorno (KNCR11). O DY médio da carteira é de aproximadamente <strong id="avgDY">7.76%</strong>. A resiliência geral é considerada média-alta, com boa proteção contra crises.</p>
                <p class="card-text"><strong>Recomendação:</strong> Manter a diversificação atual, considerando aumentar posição em SNEL11 e GARE11 para reduzir risco.</p>
                <p class="last-update">Análise atualizada: <span id="summaryUpdate">carregando...</span></p>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">Como Funciona a Atualização em Tempo Real</div>
            <div class="card-body">
                <h5>Dados em tempo real</h5>
                <p>Esta página simula a atualização automática de dados a cada 30 segundos. Em uma implementação real, seria necessário:</p>
                <ol>
                    <li>Integrar com uma API de dados financeiros (como Alpha Vantage, HG Brasil, ou outra)</li>
                    <li>Configurar um backend para fazer as requisições (devido a limitações de CORS)</li>
                    <li>Obter uma chave de API do provedor de dados</li>
                </ol>
                <p>Os dados atuais são simulados para demonstração da interface.</p>
            </div>
        </div>
        
        <footer>
            <p>Última atualização: <span id="fullDate">carregando...</span> | Dados simulados para fins de demonstração</p>
            <p>© 2023 - Análise de Fundos Imobiliários em Tempo Real</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Dados iniciais dos fundos (serão atualizados periodicamente)
        const fiis = {
            'GARE11': { price: 105.32, variation: 0.85, dy: 7.8, pvp: 0.92, composition: 'Galpões Logísticos', management: 'Vinci Partners', fee: 0.5, wualt: 'Alta', default: 1.2, debt: 28, shareholders: '12.450', resilience: 'Alta', lastIncome: 0.82 },
            'CACR11': { price: 97.85, variation: -0.42, dy: 8.2, pvp: 1.05, composition: 'Crédito Imobiliário', management: 'BTG Pactual', fee: 0.8, wualt: 'Média', default: 3.5, debt: 35, shareholders: '8.720', resilience: 'Média', lastIncome: 0.78 },
            'KNCR11': { price: 88.50, variation: 1.25, dy: 9.1, pvp: 0.87, composition: 'Títulos e Débentures', management: 'Kinea', fee: 0.6, wualt: 'Baixa', default: 4.8, debt: 42, shareholders: '6.350', resilience: 'Baixa', lastIncome: 0.85 },
            'SNEL11': { price: 112.75, variation: 0.35, dy: 6.5, pvp: 1.12, composition: 'Energia Solar', management: 'Suno', fee: 0.7, wualt: 'Alta', default: 0.8, debt: 22, shareholders: '15.800', resilience: 'Alta', lastIncome: 0.75 },
            'XPML11': { price: 99.90, variation: -0.15, dy: 7.2, pvp: 0.96, composition: 'Shoppings e Lajes', management: 'XP Investimentos', fee: 0.9, wualt: 'Média', default: 2.1, debt: 38, shareholders: '20.150', resilience: 'Média', lastIncome: 0.68 }
        };

        // Função para formatar números como moeda brasileira
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);
        }

        // Função para formatar porcentagens
        function formatPercent(value) {
            return value.toFixed(2) + '%';
        }

        // Função para atualizar a tabela com os dados
        function updateTable() {
            const tableBody = document.getElementById('fiiTableBody');
            const tableBody2 = document.getElementById('fiiTableBody2');
            
            tableBody.innerHTML = '';
            tableBody2.innerHTML = '';
            
            for (const [ticker, data] of Object.entries(fiis)) {
                // Determina a classe com base na variação
                const variationClass = data.variation >= 0 ? 'positive' : 'negative';
                const variationIcon = data.variation >= 0 ? '▲' : '▼';
                
                // Primeira tabela
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${ticker}</strong></td>
                    <td>${formatCurrency(data.price)}</td>
                    <td class="${variationClass}">${variationIcon} ${Math.abs(data.variation).toFixed(2)}%</td>
                    <td class="positive">${formatPercent(data.dy)}</td>
                    <td>${data.pvp}</td>
                    <td>${data.composition}</td>
                    <td>${data.management}</td>
                    <td>${formatPercent(data.fee)}</td>
                `;
                tableBody.appendChild(row);
                
                // Segunda tabela
                const row2 = document.createElement('tr');
                row2.innerHTML = `
                    <td><strong>${ticker}</strong></td>
                    <td class="${data.wualt === 'Alta' ? 'positive' : data.wualt === 'Baixa' ? 'negative' : 'neutral'}">${data.wualt}</td>
                    <td class="${data.default < 2 ? 'positive' : data.default > 4 ? 'negative' : 'neutral'}">${formatPercent(data.default)}</td>
                    <td class="${data.debt < 30 ? 'positive' : data.debt > 40 ? 'negative' : 'neutral'}">${formatPercent(data.debt)}</td>
                    <td>${data.shareholders}</td>
                    <td class="${data.resilience === 'Alta' ? 'positive' : data.resilience === 'Baixa' ? 'negative' : 'neutral'}">${data.resilience}</td>
                    <td>${formatCurrency(data.lastIncome)}</td>
                `;
                tableBody2.appendChild(row2);
                
                // Atualiza os preços nas análises
                document.getElementById(`${ticker.toLowerCase()}Price`).textContent = formatCurrency(data.price);
                document.getElementById(`${ticker.toLowerCase()}Update`).textContent = `Var: ${data.variation >= 0 ? '+' : ''}${data.variation.toFixed(2)}%`;
            }
            
            // Atualiza a média do DY
            const avgDY = Object.values(fiis).reduce((sum, fii) => sum + fii.dy, 0) / Object.keys(fiis).length;
            document.getElementById('avgDY').textContent = formatPercent(avgDY);
            
            // Atualiza o horário da última atualização
            const now = new Date();
            document.getElementById('lastUpdate').textContent = `Última atualização: ${now.toLocaleTimeString('pt-BR')}`;
            document.getElementById('summaryUpdate').textContent = now.toLocaleString('pt-BR');
            document.getElementById('fullDate').textContent = now.toLocaleString('pt-BR');
        }

        // Função para simular mudanças nos dados (em um caso real, isso viria de uma API)
        function updateData() {
            for (const ticker in fiis) {
                // Simula variação de preço entre -1.5% e +1.5%
                const change = (Math.random() * 3 - 1.5);
                fiis[ticker].variation = change;
                fiis[ticker].price = fiis[ticker].price * (1 + change/100);
                
                // Simula pequenas variações nos outros dados
                fiis[ticker].dy += (Math.random() * 0.2 - 0.1);
                fiis[ticker].pvp += (Math.random() * 0.02 - 0.01);
                fiis[ticker].default += (Math.random() * 0.1 - 0.05);
                fiis[ticker].debt += (Math.random() * 0.2 - 0.1);
                fiis[ticker].lastIncome += (Math.random() * 0.02 - 0.01);
                
                // Garante que os valores não fiquem fora de faixas razoáveis
                fiis[ticker].dy = Math.max(5, Math.min(10, fiis[ticker].dy));
                fiis[ticker].pvp = Math.max(0.8, Math.min(1.2, fiis[ticker].pvp));
                fiis[ticker].default = Math.max(0.5, Math.min(5, fiis[ticker].default));
                fiis[ticker].debt = Math.max(20, Math.min(45, fiis[ticker].debt));
            }
            
            updateTable();
        }

        // Inicializa a tabela
        updateTable();
        
        // Atualiza os dados a cada 30 segundos (simulado)
        setInterval(updateData, 30000);
        
        // Configura a funcionalidade de busca
        document.getElementById('searchInput').addEventListener('keyup', function() {
            const filter = this.value.toLowerCase();
            const tables = document.querySelectorAll('tbody');
            
            tables.forEach(table => {
                const tr = table.getElementsByTagName('tr');
                
                for (let i = 0; i < tr.length; i++) {
                    const td = tr[i].getElementsByTagName('td');
                    let show = false;
                    
                    for (let j = 0; j < td.length; j++) {
                        if (td[j].textContent.toLowerCase().indexOf(filter) > -1) {
                            show = true;
                            break;
                        }
                    }
                    
                    tr[i].style.display = show ? '' : 'none';
                }
            });
        });
        
        // Configura a funcionalidade de ordenação
        document.getElementById('sortSelect').addEventListener('change', function() {
            alert('Funcionalidade de ordenação será implementada em versão futura');
        });
    </script>
</body>
</html>
